<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chel Edge - NHL Edge Stats</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'caps-red': '#C8102E',
                        'caps-navy': '#041E42',
                        'dark-bg': '#1a1a2e',
                        'dark-card': '#16213e',
                        'dark-border': '#374151'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark-bg text-white min-h-screen">
    <!-- Header -->
    <header class="bg-caps-navy border-b border-dark-border">
        <div class="container mx-auto px-4 py-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold text-caps-red">Chel Edge</h1>
                    <p class="text-gray-400 mt-1">NHL Edge stats in a comprehensive, sortable format</p>
                </div>
                <div class="mt-4 md:mt-0 text-sm text-gray-400">
                    <span id="last-updated">Loading...</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Filter Bar -->
    <div class="bg-dark-card border-b border-dark-border">
        <div class="max-w-[1800px] mx-auto px-4 py-3">
            <div class="flex flex-wrap items-center gap-3">
                <label class="text-sm text-gray-400">View:</label>
                <select id="filter-type" class="bg-dark-bg border border-dark-border rounded px-3 py-1.5 text-sm text-white focus:outline-none focus:border-caps-red">
                    <option value="team">Team</option>
                    <option value="division">Division</option>
                    <option value="conference">Conference</option>
                    <option value="league">League</option>
                </select>

                <select id="filter-team" class="bg-dark-bg border border-dark-border rounded px-3 py-1.5 text-sm text-white focus:outline-none focus:border-caps-red">
                    <option value="WSH">Washington Capitals</option>
                </select>

                <select id="filter-division" class="hidden bg-dark-bg border border-dark-border rounded px-3 py-1.5 text-sm text-white focus:outline-none focus:border-caps-red">
                    <option value="Metropolitan">Metropolitan</option>
                    <option value="Atlantic">Atlantic</option>
                    <option value="Central">Central</option>
                    <option value="Pacific">Pacific</option>
                </select>

                <select id="filter-conference" class="hidden bg-dark-bg border border-dark-border rounded px-3 py-1.5 text-sm text-white focus:outline-none focus:border-caps-red">
                    <option value="Eastern">Eastern Conference</option>
                    <option value="Western">Western Conference</option>
                </select>

                <span id="player-count" class="text-sm text-gray-500 ml-auto"></span>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-[1800px] mx-auto px-4 py-6">
        <!-- Loading State -->
        <div id="loading" class="flex items-center justify-center py-20">
            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-caps-red"></div>
            <span class="ml-4 text-gray-400">Loading player data...</span>
        </div>

        <!-- Error State -->
        <div id="error" class="hidden bg-red-900/30 border border-red-500 rounded-lg p-6 text-center">
            <p class="text-red-400">Failed to load player data. Please try again later.</p>
        </div>

        <!-- Info Section -->
        <div id="info-section" class="hidden info-section">
            <button class="info-toggle" id="info-toggle">How to read this data ▼</button>
            <div class="info-content" id="info-content">
                <div class="info-block">
                    <h3>What is Chel Edge?</h3>
                    <p>Chel Edge combines traditional NHL stats with NHL Edge tracking data in one sortable view. Filter by team, division, conference, or view the entire league. Click any column header to sort.</p>
                </div>

                <div class="info-block">
                    <h3>Understanding Percentiles</h3>
                    <p>Many stats show the raw value followed by a <span class="percentile-example">(percentile)</span> in parentheses. The percentile tells you how a player ranks league-wide among all NHL skaters with 10+ games played.</p>
                    <ul>
                        <li><strong>90th percentile</strong> = Top 10% in the league</li>
                        <li><strong>50th percentile</strong> = League average</li>
                        <li><strong>10th percentile</strong> = Bottom 10% in the league</li>
                    </ul>
                    <p>Cells are color-coded: <span class="green-example">green</span> for 75th percentile and above, <span class="red-example">red</span> for below 25th percentile.</p>
                </div>

                <div class="info-block">
                    <h3>Stats Glossary</h3>
                    <ul>
                        <li><strong>TOI</strong> — Average time on ice per game (minutes)</li>
                        <li><strong>P/60</strong> — Points per 60 minutes of ice time. Normalizes production regardless of ice time.</li>
                        <li><strong>Top Speed</strong> — Fastest skating speed recorded this season (mph)</li>
                        <li><strong>Bursts 20+/22+</strong> — Number of times player exceeded 20 or 22 mph</li>
                        <li><strong>Dist/G</strong> — Average miles skated per game</li>
                        <li><strong>O-Zone% / D-Zone%</strong> — Percentage of 5v5 time spent in offensive/defensive zone</li>
                        <li><strong>ZS%</strong> — Offensive zone start percentage (higher = more o-zone faceoffs)</li>
                        <li><strong>Shot Speed</strong> — Fastest shot recorded this season (mph)</li>
                        <li><strong>Shots/60</strong> — Shot attempts per 60 minutes of ice time</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Stats Tables -->
        <div id="table-container" class="hidden space-y-8">
            <!-- Forwards Section -->
            <div>
                <h2 class="text-xl font-bold text-caps-red mb-3">Forwards</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm" id="forwards-table">
                        <thead class="sticky top-0 z-10">
                            <tr class="bg-caps-navy text-left">
                                <th class="table-header sticky left-0 z-20 bg-caps-navy w-10" data-sort="jersey_number" data-table="forwards">#</th>
                                <th class="table-header min-w-[150px]" data-sort="name" data-table="forwards">Name</th>
                                <th class="table-header team-col hidden" data-sort="team_abbr" data-table="forwards">Team</th>
                                <th class="table-header" data-sort="position" data-table="forwards">Pos</th>
                                <th class="table-header" data-sort="games_played" data-table="forwards">GP</th>
                                <th class="table-header" data-sort="avg_toi" data-table="forwards">TOI</th>
                                <th class="table-header" data-sort="goals" data-table="forwards">G</th>
                                <th class="table-header" data-sort="assists" data-table="forwards">A</th>
                                <th class="table-header" data-sort="points" data-table="forwards">P</th>
                                <th class="table-header" data-sort="p60" data-table="forwards">P/60</th>
                                <th class="table-header" data-sort="plus_minus" data-table="forwards">+/-</th>
                                <th class="table-header" data-sort="hits" data-table="forwards">Hits</th>
                                <th class="table-header" data-sort="pim" data-table="forwards">PIM</th>
                                <th class="table-header" data-sort="shots_per_60" data-table="forwards">Shots/60</th>
                                <th class="table-header" data-sort="faceoff_win_pct" data-table="forwards">FO%</th>
                                <th class="table-header edge-header" data-sort="top_speed_mph" data-table="forwards">Top Speed</th>
                                <th class="table-header edge-header" data-sort="bursts_20_plus" data-table="forwards">Bursts 20+</th>
                                <th class="table-header edge-header" data-sort="bursts_22_plus" data-table="forwards">Bursts 22+</th>
                                <th class="table-header edge-header" data-sort="distance_per_game_miles" data-table="forwards">Dist/G</th>
                                <th class="table-header edge-header" data-sort="off_zone_time_pct" data-table="forwards">O-Zone%</th>
                                <th class="table-header edge-header" data-sort="def_zone_time_pct" data-table="forwards">D-Zone%</th>
                                <th class="table-header edge-header" data-sort="zone_starts_off_pct" data-table="forwards">ZS%</th>
                                <th class="table-header edge-header" data-sort="top_shot_speed_mph" data-table="forwards">Shot Speed</th>
                            </tr>
                        </thead>
                        <tbody id="forwards-body">
                            <!-- Forwards will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Defensemen Section -->
            <div>
                <h2 class="text-xl font-bold text-caps-red mb-3">Defensemen</h2>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm" id="defensemen-table">
                        <thead class="sticky top-0 z-10">
                            <tr class="bg-caps-navy text-left">
                                <th class="table-header sticky left-0 z-20 bg-caps-navy w-10" data-sort="jersey_number" data-table="defensemen">#</th>
                                <th class="table-header min-w-[150px]" data-sort="name" data-table="defensemen">Name</th>
                                <th class="table-header team-col hidden" data-sort="team_abbr" data-table="defensemen">Team</th>
                                <th class="table-header" data-sort="position" data-table="defensemen">Pos</th>
                                <th class="table-header" data-sort="games_played" data-table="defensemen">GP</th>
                                <th class="table-header" data-sort="avg_toi" data-table="defensemen">TOI</th>
                                <th class="table-header" data-sort="goals" data-table="defensemen">G</th>
                                <th class="table-header" data-sort="assists" data-table="defensemen">A</th>
                                <th class="table-header" data-sort="points" data-table="defensemen">P</th>
                                <th class="table-header" data-sort="p60" data-table="defensemen">P/60</th>
                                <th class="table-header" data-sort="plus_minus" data-table="defensemen">+/-</th>
                                <th class="table-header" data-sort="hits" data-table="defensemen">Hits</th>
                                <th class="table-header" data-sort="pim" data-table="defensemen">PIM</th>
                                <th class="table-header" data-sort="shots_per_60" data-table="defensemen">Shots/60</th>
                                <th class="table-header" data-sort="faceoff_win_pct" data-table="defensemen">FO%</th>
                                <th class="table-header edge-header" data-sort="top_speed_mph" data-table="defensemen">Top Speed</th>
                                <th class="table-header edge-header" data-sort="bursts_20_plus" data-table="defensemen">Bursts 20+</th>
                                <th class="table-header edge-header" data-sort="bursts_22_plus" data-table="defensemen">Bursts 22+</th>
                                <th class="table-header edge-header" data-sort="distance_per_game_miles" data-table="defensemen">Dist/G</th>
                                <th class="table-header edge-header" data-sort="off_zone_time_pct" data-table="defensemen">O-Zone%</th>
                                <th class="table-header edge-header" data-sort="def_zone_time_pct" data-table="defensemen">D-Zone%</th>
                                <th class="table-header edge-header" data-sort="zone_starts_off_pct" data-table="defensemen">ZS%</th>
                                <th class="table-header edge-header" data-sort="top_shot_speed_mph" data-table="defensemen">Shot Speed</th>
                            </tr>
                        </thead>
                        <tbody id="defensemen-body">
                            <!-- Defensemen will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Legend -->
        <div id="legend" class="hidden mt-6 p-4 bg-dark-card rounded-lg border border-dark-border">
            <h3 class="text-sm font-semibold text-gray-300 mb-2">Legend</h3>
            <div class="flex flex-wrap gap-4 text-xs text-gray-400">
                <div class="flex items-center gap-2">
                    <span class="w-4 h-4 rounded bg-green-500/30"></span>
                    <span>75th+ percentile</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="w-4 h-4 rounded bg-red-500/30"></span>
                    <span>Below 25th percentile</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-gray-500">(##)</span>
                    <span>League percentile</span>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-2">
                Data refreshed daily. Only includes skaters with 10+ games played.
            </p>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-caps-navy border-t border-dark-border mt-12">
        <div class="container mx-auto px-4 py-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-6">
                <!-- Ko-fi Button -->
                <div>
                    <a href="https://ko-fi.com/cheledge" target="_blank" rel="noopener"
                       class="inline-flex items-center gap-2 px-4 py-2 bg-[#FF5E5B] hover:bg-[#ff4744] text-white rounded-lg transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23.881 8.948c-.773-4.085-4.859-4.593-4.859-4.593H.723c-.604 0-.679.798-.679.798s-.082 7.324-.022 11.822c.164 2.424 2.586 2.672 2.586 2.672s8.267-.023 11.966-.049c2.438-.426 2.683-2.566 2.658-3.734 4.352.24 7.422-2.831 6.649-6.916zm-11.062 3.511c-1.246 1.453-4.011 3.976-4.011 3.976s-.121.119-.31.023c-.076-.057-.108-.09-.108-.09-.443-.441-3.368-3.049-4.034-3.954-.709-.965-1.041-2.7-.091-3.71.951-1.01 3.005-1.086 4.363.407 0 0 1.565-1.782 3.468-.963 1.904.82 1.832 3.011.723 4.311z"/>
                        </svg>
                        If you find this useful, buy me a coffee
                    </a>
                </div>

                <!-- Disclaimer -->
                <div class="text-xs text-gray-500 text-center md:text-right">
                    <p>Data sourced from NHL Edge. Not affiliated with the NHL.</p>
                    <p class="mt-1">&copy; 2026 Chel Edge</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="app.js"></script>
</body>
</html>
